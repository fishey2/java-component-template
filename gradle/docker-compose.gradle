dockerCompose {

    useComposeFiles = ['docker-compose.yml']
    startedServices = ['activemq']
    buildBeforeUp = true

    removeImages = "Local" // Other accepted values are: "All" and "Local"

    functional {
        useComposeFiles = ['docker-compose-test.yml']
        startedServices = ['component']
        buildBeforeUp = true

        removeImages = "Local" // Other accepted values are: "All" and "Local"
    }
}

functionalComposeBuild.dependsOn(bootJar)
functionalComposeUp.dependsOn(bootJar)
functionalTest.dependsOn(functionalComposeUp)
functionalTest.finalizedBy(functionalComposeDownForced)

test.dependsOn(composeUp)
test.finalizedBy(composeDownForced)